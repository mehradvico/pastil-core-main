@using Application.Common.Dto.Result
@using Application.Common.Helpers
@using Application.Common.Enumerable
@using Application.Services.Order.ProductOrderSrv.Dto
@model BaseResultDto<PaymentDto>

@{
    ViewData["Title"] = "بازگشت از پرداخت";
    var p = Model?.Data;

    var isSuccess = Model?.IsSuccess == true;

    var returnUrl =
        TempData["ReturnToSiteUrl"]?.ToString()
        ?? AppSettingsHelper.BaseUrl;

    var orderId = p?.ProductOrderId;
    var refNumber = p?.RefNumber;
    var amount = p?.Amount;
}

<link href="~/assets/payment/css/style.css" rel="stylesheet" />

<section class="payment-page">
    <div class="payment-card">

        <div class="brand">
            <img class="brand-logo" src="~/Assets/Payment/images/Logo.png" alt="PASTIL" />
        </div>

        <div class="status-icon">
            @if (isSuccess)
            {
                <img src="~/Assets/Payment/images/Success.png" alt="success" />
            }
            else
            {
                <img src="~/Assets/Payment/images/False.png" alt="failed" />
            }
        </div>

        <div class="status-text">
            @if (isSuccess)
            {
                <strong>@Resource.Notification.Success</strong>
            }
            else
            {
                <strong>@Resource.Notification.Unsuccess</strong>
            }
        </div>

        @if (p != null)
        {
            <ul class="info-list">
                @if (p.Type?.Label == PaymentTypeEnum.PaymentType_ProductOrder.ToString())
                {
                    @if (!string.IsNullOrWhiteSpace(orderId))
                    {
                        <li>
                            <span>شماره سفارش</span>
                            <b>@orderId</b>
                        </li>
                    }
                }
                else if (p.Type?.Label == PaymentTypeEnum.PaymentType_Wallet.ToString()
                && p.CallBackTypeLabel == PaymentCallbackTypeEnum.ProductOrder.ToString())
                {
                    @if (!string.IsNullOrWhiteSpace(p.CallBackId))
                    {
                        <li>
                            <span>شماره سفارش</span>
                            <b>@p.CallBackId</b>
                        </li>
                    }
                }

                @if (!string.IsNullOrWhiteSpace(refNumber))
                {
                    <li>
                        <span>پیگیری پرداخت</span>
                        <b>@refNumber</b>
                    </li>
                }

                @if (amount.HasValue)
                {
                    <li>
                        <span>مبلغ</span>
                        <b>@amount.Value.ToString("n0") تومان</b>
                    </li>
                }
            </ul>
        }

        <div class="actions">
            <a class="btn-return" href="@returnUrl">بازگشت به سایت</a>
        </div>

    </div>
</section>
